<view class="debug-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ğŸ”§ Supabase æ•°æ®åº“è°ƒè¯•å·¥å…·</text>
    <text class="page-subtitle">è¯Šæ–­å’Œä¿®å¤æ•°æ®åº“è¿æ¥é—®é¢˜</text>
  </view>

  <!-- å¿«é€Ÿå¯¼èˆª -->
  <view class="action-section">
    <view class="button-group">
      <t-button 
        theme="primary" 
        size="medium"
        variant="outline"
        bindtap="goToConnectionTest"
        block>
        ğŸ”— è¿æ¥æµ‹è¯•
      </t-button>
      <t-button 
        theme="primary" 
        size="medium"
        variant="outline"
        bindtap="goToDynamicCrudTest"
        block>
        âš¡ åŠ¨æ€æµ‹è¯•
      </t-button>
    </view>
  </view>

  <!-- è¿æ¥çŠ¶æ€ -->
  <view class="status-section">
    <view class="status-card">
      <text class="status-label">è¿æ¥çŠ¶æ€ï¼š</text>
      <text class="status-value {{connectionStatus === 'è¿æ¥æ­£å¸¸' ? 'status-success' : 'status-error'}}">
        {{connectionStatus}}
      </text>
    </view>
    
    <view class="status-card" wx:if="{{dbInfo}}">
      <text class="status-label">æ•°æ®åº“ä¿¡æ¯ï¼š</text>
      <text class="status-value">{{dbInfo.status}}</text>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <view class="button-group">
      <t-button 
        theme="primary" 
        size="medium"
        bindtap="testConnection"
        loading="{{isTesting && currentTest.includes('è¿æ¥')}}"
        disabled="{{isTesting}}">
        æµ‹è¯•è¿æ¥
      </t-button>
      
      <t-button 
        theme="primary" 
        size="medium"
        variant="outline"
        bindtap="checkTableStructure"
        loading="{{isTesting && currentTest.includes('ç»“æ„')}}"
        disabled="{{isTesting}}">
        æ£€æŸ¥è¡¨ç»“æ„
      </t-button>
    </view>
    
    <view class="button-group">
      <t-button 
        theme="success" 
        size="medium"
        bindtap="testUserOperations"
        loading="{{isTesting && currentTest.includes('ç”¨æˆ·')}}"
        disabled="{{isTesting}}"
        wx:if="{{userInfo}}">
        æµ‹è¯•ç”¨æˆ·æ“ä½œ
      </t-button>
      
      <t-button 
        theme="warning" 
        size="medium"
        variant="outline"
        bindtap="runFullTestSuite"
        loading="{{isTesting && currentTest.includes('å®Œæ•´')}}"
        disabled="{{isTesting}}">
        å®Œæ•´æµ‹è¯•
      </t-button>
    </view>
    
    <view class="button-group">
      <t-button 
        theme="danger" 
        size="small"
        variant="outline"
        bindtap="cleanupTestData"
        disabled="{{isTesting}}">
        æ¸…ç†æµ‹è¯•æ•°æ®
      </t-button>
      
      <t-button 
        theme="default" 
        size="small"
        variant="outline"
        bindtap="clearResults"
        disabled="{{isTesting}}">
        æ¸…ç©ºç»“æœ
      </t-button>
    </view>
  </view>

  <!-- å½“å‰æµ‹è¯•çŠ¶æ€ -->
  <view class="testing-status" wx:if="{{isTesting}}">
    <t-loading theme="spinner" size="20px" />
    <text class="testing-text">{{currentTest}}</text>
  </view>

  <!-- æµ‹è¯•ç»“æœ -->
  <view class="results-section" wx:if="{{testResults.length > 0}}">
    <view class="section-header">
      <text class="section-title">ğŸ“Š æµ‹è¯•ç»“æœ</text>
      <text class="result-count">{{testResults.length}} é¡¹</text>
    </view>
    
    <scroll-view scroll-y class="results-scroll">
      <view class="result-item" wx:for="{{testResults}}" wx:key="time">
        <view class="result-header">
          <t-tag 
            theme="{{item.type === 'success' ? 'success' : item.type === 'error' ? 'danger' : 'primary'}}" 
            size="small">
            {{item.type === 'success' ? 'æˆåŠŸ' : item.type === 'error' ? 'å¤±è´¥' : 'ä¿¡æ¯'}}
          </t-tag>
          <text class="result-time">{{item.time}}</text>
        </view>
        <text class="result-message">{{item.message}}</text>
        <view class="result-data" wx:if="{{item.data}}">
          <text class="data-label">æ•°æ®ï¼š</text>
          <text class="data-content">{{item.formattedData}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æ•°æ®åº“ç”¨æˆ·åˆ—è¡¨ -->
  <view class="users-section" wx:if="{{dbUsers.length > 0}}">
    <view class="section-header">
      <text class="section-title">ğŸ‘¥ æ•°æ®åº“ç”¨æˆ· ({{dbUsers.length}})</text>
    </view>
    
    <scroll-view scroll-y class="users-scroll">
      <t-cell-group>
        <t-cell 
          wx:for="{{dbUsers}}" 
          wx:key="id"
          title="{{item.nickname || 'æœªå‘½åç”¨æˆ·'}}"
          description="ID: {{item.id}} | OpenID: {{item.openid}}"
          note="{{item.created_at}}">
        </t-cell>
      </t-cell-group>
    </scroll-view>
  </view>

  <!-- é”™è¯¯ä¿¡æ¯ -->
  <view class="errors-section" wx:if="{{errors.length > 0}}">
    <view class="section-header">
      <text class="section-title">âŒ é”™è¯¯ä¿¡æ¯</text>
      <text class="error-count">{{errors.length}} é¡¹</text>
    </view>
    
    <scroll-view scroll-y class="errors-scroll">
      <view class="error-item" wx:for="{{errors}}" wx:key="time" data-index="{{index}}" bindtap="copyErrorInfo">
        <view class="error-header">
          <text class="error-context">{{item.context}}</text>
          <text class="error-time">{{item.time}}</text>
        </view>
        <text class="error-message">{{item.message}}</text>
        <text class="copy-hint">ç‚¹å‡»å¤åˆ¶è¯¦ç»†ä¿¡æ¯</text>
      </view>
    </scroll-view>
  </view>

  <!-- è¿”å›æŒ‰é’® -->
  <view class="footer-section">
    <t-button 
      theme="primary" 
      size="large"
      block
      bindtap="goBack">
      è¿”å›é¦–é¡µ
    </t-button>
  </view>
</view>