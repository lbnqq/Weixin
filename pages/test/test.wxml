<!--pages/test/test.wxml-->
<view class="container">
  <!-- 调试信息（开发时显示） -->
  <view style="background: #f0f0f0; padding: 10rpx; margin: 10rpx; border-radius: 8rpx; font-size: 24rpx;">
    <text>调试信息：当前题目ID: {{currentQuestion}}, 题目对象: {{question ? '已加载' : '未加载'}}</text>
    <text wx:if="{{debugInfo}}">调试详情: {{debugInfo}}</text>
    <button style="margin: 10rpx; padding: 10rpx; background: #e6f7ff; border: 1px solid #91d5ff;" bindtap="testDataLoading">测试数据加载</button>
  </view>

  <!-- 进度条 -->
  <view class="progress-section">
    <view class="progress-header">
      <text class="progress-title">大五人格测试</text>
      <text class="progress-text">{{currentQuestion}}/{{totalQuestions}}</text>
    </view>
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{currentQuestion / totalQuestions * 100}}%"></view>
    </view>
  </view>

  <!-- 题目卡片 -->
  <view wx:if="{{question}}" class="question-card">
    <view class="question-header">
      <text class="question-number">第 {{currentQuestion}} 题</text>
      <text class="question-dimension">{{question.dimension}}</text>
    </view>

    <view class="question-content">
      <text class="question-text">{{question.text}}</text>
      <text class="question-text-en">{{question.textEn}}</text>
    </view>

    <view class="options-section">
      <view class="options-title">请选择您的答案：</view>

      <view class="options-list">
        <view wx:for="{{[1,2,3,4,5]}}" wx:key="*this"
              class="option-item {{selectedAnswer === item ? 'selected' : ''}}"
              bindtap="selectAnswer" data-value="{{item}}">
          <view class="option-radio">
            <view class="radio-circle {{selectedAnswer === item ? 'checked' : ''}}"></view>
          </view>
          <view class="option-text">
            <text wx:if="{{item === 1}}">完全不同意</text>
            <text wx:if="{{item === 2}}">不同意</text>
            <text wx:if="{{item === 3}}">中立</text>
            <text wx:if="{{item === 4}}">同意</text>
            <text wx:if="{{item === 5}}">完全同意</text>
          </view>
        </view>
      </view>
    </view>

    <view class="navigation-section">
      <button wx:if="{{currentQuestion > 1}}"
              class="nav-btn prev-btn"
              bindtap="prevQuestion">上一题</button>

      <button wx:if="{{currentQuestion < totalQuestions}}"
              class="nav-btn next-btn {{selectedAnswer === null ? 'disabled' : ''}}"
              bindtap="nextQuestion">下一题</button>

      <button wx:if="{{currentQuestion === totalQuestions}}"
              class="nav-btn submit-btn {{selectedAnswer === null ? 'disabled' : ''}}"
              bindtap="submitTest">提交测试</button>
    </view>
  </view>

  <!-- 题目未加载时的提示 -->
  <view wx:else class="loading-section">
    <text class="loading-text">正在加载题目...</text>
  </view>

  <!-- 提示信息 -->
  <view class="tips-section">
    <view class="tip-item">
      <text class="tip-icon">💡</text>
      <text class="tip-text">请根据您的真实情况选择答案</text>
    </view>
    <view class="tip-item">
      <text class="tip-icon">⏰</text>
      <text class="tip-text">测试进度会自动保存</text>
    </view>
  </view>
</view>